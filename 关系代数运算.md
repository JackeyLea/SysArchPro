## 环境

- sqlite 3.46.1

不同数据库、不同版本可能会有顺序上的差异，支持的关系运算符号也可能不同。

## 测试数据 

### 表R

| A | B | C |
| - | - | - |
| $a_1$ | $b_1$ | $c_1$
| $a_1$ | $b_2$ | $c_2$
| $a_2$ | $b_2$ | $c_1$

### 表S

| A | B | C |
| - | - | - |
| $a_1$ | $b_2$ | $c_2$
| $a_1$ | $b_3$ | $c_2$
| $a_2$ | $b_2$ | $c_1$

建立R/S两个表，表中内容和示例一样。

## 1.传统的集合运算

### 1.1.交/$\cap$/Intersection

R $\cap$ S表示取两个集合中重复部分

| A | B | C |
| - | - | - |
| $a_1$ | $b_2$ | $c_2$
| $a_2$ | $b_2$ | $c_1$

对应SQL语句

```sql
select * from R
intersect
select * from S;
```

### 1.2.并/$\cup$/Union

R $\cup$ S表示取两个合集中所有部分且去重。

| A | B | C |
| - | - | - |
| $a_1$ | $b_1$ | $c_1$
| $a_1$ | $b_2$ | $c_2$
| $a_2$ | $b_2$ | $c_1$
| $a_1$ | $b_3$ | $c_2$

对应SQL语句

```sql
select * from R
union
select * from S;
```

### 1.3.差/-/Difference

R-S表示R中有而S中没有的

| A | B | C |
| - | - | - |
| $a_1$ | $b_1$ | $c_1$

对应SQL语句

```sql
select * from R
except
select * from S;
```

### 1.4.笛卡尔积/$\times$/Cartesian Product

R $\times$ S集合R与集合S的每个元组进行连接。

| R.A | R.B | R.C | S.A | S.B | S.C
| - | - | - | - | - | - |
| $a_1$ | $b_1$ | $c_1$ | $a_1$ | $b_2$ | $c_2$ |
| $a_1$ | $b_1$ | $c_1$ | $a_1$ | $b_3$ | $c_2$ |
| $a_1$ | $b_1$ | $c_1$ | $a_2$ | $b_2$ | $c_1$ |
| $a_1$ | $b_2$ | $c_2$ | $a_1$ | $b_2$ | $c_2$ |
| $a_1$ | $b_2$ | $c_2$ | $a_1$ | $b_3$ | $c_2$ |
| $a_1$ | $b_2$ | $c_2$ | $a_2$ | $b_2$ | $c_1$ |
| $a_2$ | $b_2$ | $c_1$ | $a_1$ | $b_2$ | $c_2$ |
| $a_2$ | $b_2$ | $c_1$ | $a_1$ | $b_3$ | $c_2$ |
| $a_2$ | $b_2$ | $c_1$ | $a_2$ | $b_2$ | $c_1$ |

数据的操作

```sql
select * from R,S;
```

## 2.专门的关系运算

### 2.1.选择/$\sigma$/Selection

选择就是对表在水平方向上，筛选出一定符合条件的元组，然后组成新的关系

$\sigma_{A="a1" \bigwedge B="b1"}(R)$表示从R中选择A为$a_1$或者B为$b_1$的元组

| A | B | C |
| - | - | - |
| $a_1$ | $b_1$ | $c_1$

数据库操作

```sql
select * from R where A='a1' and B='b1';
```

$\bigwedge$表示且，$\bigvee$表示或

### 2.2.投影/$\Pi$/Projection

大写的$\pi$

投影就是对表在垂直方向上，对列进行筛选。

$\Pi_{A,C}(R)$表示从R中对A和C列进行投影，如果投影中有重复元组就去掉。

| A | C |
| - | - |
| $a_1$ | $c_1$
| $a_1$ | $c_2$
| $a_2$ | $c_1$

对应SQL语句

```sql
select A,C from R;
```

### 2.3.连接/$\bowtie$/Join

连接就是根据给定的条件，从两个已知的关系R和S的笛卡尔集中，选取满足连接条件的若干元组，组成一个新的关系。

#### 2.3.1.内连接

##### 2.3.1.1等值连接

选取满足条件的元组组成新关系

##### 2.3.1.2.条件连接

选取满足等值条件的元组组成的关系

##### 2.3.1.3.自然连接/Natural Join
($\bowtie$)

也是等值连接，只不过它是选取满足公共属性满足等值的元组，组成关系

表R

| A|B|C|
|-|-|-|
|a|b|c
|b|a|d
|c|d|e
|d|f|g

表S
| A|C|D
|-|-|-
| a|c|d
|d|f|g
|b|d|g

R $\bowtie$ S

| A|B|C|D
|-|-|-|-
|a|b|c|d
|b|a|d|g

#### 2.3.2.外连接

不重要

##### 2.3.2.1.左外连接/Left Outer Join/$\ltimes$

不重要

##### 2.3.2.2.右外连接/Right Outer Join/$\rtimes$

不重要

##### 2.3.2.3.全外连接/Full Outer Join/$\bowtie$

不重要

#### 2.3.3.自然连接

#### 2.3.4.交叉连接

交叉连接就是笛卡尔积$\times$